module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},25940,a=>{"use strict";let b=()=>null;a.s(["getToken",0,b,"getUserId",0,()=>{let a=b();if(!a)return null;try{let b=a.split(".")[1],c=JSON.parse(atob(b));return c.sub||c.userId||c.user_id||c.id||null}catch(a){return console.error("Cannot decode token:",a),null}},"removeToken",0,()=>{},"setToken",0,a=>{}])},74248,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(2415),a.i(25940);let d=(0,c.createContext)(null);a.s(["SocketProvider",0,({children:a})=>{let e=(0,c.useRef)(null),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(""),j=(0,c.useRef)({onMessageSent:null,onMessageReceived:null}),k=(0,c.useRef)({onCallInitiated:null,onIncomingCall:null,onCallAnswered:null,onCallRejected:null,onCallEnded:null,onCallFailed:null,onWebRTCOffer:null,onWebRTCAnswer:null,onICECandidate:null}),l=(0,c.useCallback)(a=>{j.current={...j.current,...a}},[]),m=(0,c.useCallback)(a=>{Object.keys(a).some(b=>k.current[b]!==a[b])&&(k.current={...k.current,...a})},[]);(0,c.useEffect)(()=>{},[]);let n=(0,c.useCallback)(a=>{if(!e.current||!f)return!1;try{return e.current.emit("send_message",a),!0}catch{return!1}},[f]),o=(0,c.useCallback)((a,b)=>{if(e.current&&f)try{e.current.emit("typing",{conversationId:a,isTyping:b})}catch{}},[f]),p=(0,c.useCallback)(a=>{if(!e.current||!f)return console.error("âŒ Socket not connected or socketRef is null"),!1;try{return console.log("ðŸ“¡ Emitting call:initiate event:",a),e.current.emit("call:initiate",a),!0}catch(a){return console.error("âŒ Error emitting call:initiate:",a),!1}},[f]),q=(0,c.useCallback)(a=>{if(!e.current||!f)return!1;try{return e.current.emit("call:answer",{callId:a}),!0}catch{return!1}},[f]),r=(0,c.useCallback)(a=>{if(!e.current||!f)return!1;try{return e.current.emit("call:reject",{callId:a}),!0}catch{return!1}},[f]),s=(0,c.useCallback)(a=>{if(!e.current||!f)return!1;try{return e.current.emit("call:end",{callId:a}),!0}catch{return!1}},[f]),t=(0,c.useCallback)((a,b)=>{if(!e.current||!f)return!1;try{return e.current.emit("webrtc:offer",{to:a,offer:b}),!0}catch{return!1}},[f]),u=(0,c.useCallback)((a,b)=>{if(!e.current||!f)return!1;try{return e.current.emit("webrtc:answer",{to:a,answer:b}),!0}catch{return!1}},[f]),v=(0,c.useCallback)((a,b)=>{if(!e.current||!f)return!1;try{return e.current.emit("webrtc:ice-candidate",{to:a,candidate:b}),!0}catch{return!1}},[f]),w=(0,c.useMemo)(()=>({socket:e.current,isConnected:f,error:h,sendMessage:n,sendTypingIndicator:o,registerMessageCallbacks:l,initiateCall:p,answerCall:q,rejectCall:r,endCall:s,sendWebRTCOffer:t,sendWebRTCAnswer:u,sendICECandidate:v,registerCallCallbacks:m}),[f,h,n,o,l,p,q,r,s,t,u,v,m]);return(0,b.jsx)(d.Provider,{value:w,children:a})},"useSocket",0,()=>{let a=(0,c.useContext)(d);if(!a)throw Error("useSocket must be used within SocketProvider");return a}])},33508,70106,a=>{"use strict";var b=a.i(72131);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],70106);let h=g("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);a.s(["X",()=>h],33508)},5193,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33508),e=a.i(50944);let f=(0,c.createContext)(null),g=async()=>!1,h=({notification:a,onClose:e,onClick:f})=>{let g=(0,c.useMemo)(()=>{if(a.senderName&&"Unknown User"!==a.senderName)return a.senderName;let b=a.senderFirstName||"",c=a.senderLastName||"";return`${b} ${c}`.trim()||"Unknown User"},[a.senderFirstName,a.senderLastName,a.senderName]);return(0,b.jsx)("div",{onClick:()=>{f(a),e(a.id)},className:"w-[320px] bg-white rounded-xl shadow-lg border border-sky-100 p-3 cursor-pointer hover:shadow-xl hover:-translate-y-0.5 transition-all duration-200",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("img",{src:a.avatar||"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_640.png",alt:g,className:"w-10 h-10 rounded-full object-cover border border-sky-200 flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-800 leading-snug",children:[(0,b.jsx)("span",{className:"font-semibold mr-1",children:g}),a.message||"Ä‘Ã£ gá»­i má»™t thÃ´ng bÃ¡o cho báº¡n."]}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:i(a.createdDate)}),a.postId&&(0,b.jsx)("p",{className:"text-xs text-sky-600 font-medium mt-1",children:"Click Ä‘á»ƒ xem â†’"})]}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),e(a.id)},className:"ml-1 text-gray-400 hover:text-gray-600",children:(0,b.jsx)(d.X,{size:14})})]})})},i=a=>{if(!a)return"Vá»«a xong";let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/1e3);return c<60?"Vá»«a xong":c<3600?`${Math.floor(c/60)} ph\xfat trÆ°á»›c`:c<86400?`${Math.floor(c/3600)} giá» trÆ°á»›c`:b.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"})};a.s(["NotificationProvider",0,({children:a})=>{let[d,g]=(0,c.useState)([]),[i,j]=(0,c.useState)("toast"),[k,l]=(0,c.useState)(0),m=(0,e.useRouter)(),n=(0,c.useCallback)(a=>{console.log("ðŸ”” Adding notification:",a),g(b=>{var c;if(!a?.id)return console.warn("âš ï¸ Notification missing ID"),b;if(b.some(b=>b.id===a.id))return console.log("âš ï¸ Notification already exists:",a.id),b;let d=[a.senderFirstName,a.senderLastName].filter(Boolean).join(" ")||a.senderName||"Unknown User",e={id:a.id,senderFirstName:a.senderFirstName,senderLastName:a.senderLastName,senderName:d,avatar:a.avatar||a.senderImageUrl,message:a.content||a.message,createdDate:a.createdDate||a.timestamp||new Date().toISOString(),type:a.type||"general",seen:a.seen??a.read??!1,postId:a.postId,senderId:a.senderId};return"undefined"!=typeof document&&document.hidden&&(c=0),l(a=>a+1),console.log("âœ… Notification added to state"),[e,...b]})},[]),o=(0,c.useCallback)(a=>{g(a)},[]),p=(0,c.useCallback)(a=>{g(b=>b.filter(b=>b.id!==a))},[]),q=(0,c.useCallback)(a=>{a.onClick&&a.onClick(a),a.postId&&m.push(`/post/${a.postId}`),p(a.id)},[m,p]),r=(0,c.useMemo)(()=>({notifications:d,addNotification:n,removeNotification:p,setNotificationsList:o,setMode:j,mode:i,notificationCounter:k}),[d,n,p,o,i,k]);return(0,b.jsxs)(f.Provider,{value:r,children:[a,(0,b.jsx)("div",{className:"fixed top-4 right-4 z-[9999] space-y-3 max-h-screen overflow-y-auto pointer-events-none",children:(0,b.jsx)("div",{className:"pointer-events-auto",children:"toast"===i&&d.map(a=>(0,b.jsx)(h,{notification:a,onClose:p,onClick:q},a.id))})})]})},"requestNotificationPermission",0,g,"useNotification",0,()=>{let a=(0,c.useContext)(f);if(!a)throw Error("useNotification must be used within NotificationProvider");return a}])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1d9a4e50._.js.map