{"version":3,"sources":["../../../../src/app/authenticate/page.tsx"],"sourcesContent":["'use client'\n\nimport React, { useEffect, useState, Suspense } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { API_BASE_URL } from \"@/lib/utils/constants\";\nimport { setToken } from \"@/lib/utils/auth\";\nimport axios from \"axios\";\nimport toast from \"react-hot-toast\";\n\nfunction AuthenticateContent() {\n    const [isLoading, setIsLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const router = useRouter();\n    const searchParams = useSearchParams();\n\n    useEffect(() => {\n        const authenticateWithGoogle = async () => {\n            const code = searchParams.get('code');\n\n            if (!code) {\n                setError('No authorization code received');\n                setIsLoading(false);\n                return;\n            }\n\n            try {\n                const response = await axios.post(\n                    `${API_BASE_URL}/identity/auth/outbound/authentication?code=${code}`\n                );\n\n                if (response.data?.code === 1000 && response.data?.result?.token) {\n                    setToken(response.data.result.token);\n                    toast.success('Login successful!');\n                    router.push('/');\n                } else {\n                    throw new Error(response.data?.message || 'Authentication failed');\n                }\n            } catch (err: any) {\n                console.error('Authentication error:', err);\n                setError(err.response?.data?.message || err.message || 'Authentication failed');\n                toast.error('Could not complete Google login');\n            } finally {\n                setIsLoading(false);\n            }\n        };\n\n        authenticateWithGoogle();\n    }, [searchParams, router]);\n\n    return (\n        <div className=\"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 text-center\">\n            {isLoading ? (\n                <>\n                    <div className=\"w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-br from-sky-100 to-blue-100 flex items-center justify-center\">\n                        <svg className=\"w-8 h-8 text-sky-500 animate-spin\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                            <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                            <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                        </svg>\n                    </div>\n                    <h2 className=\"text-xl font-bold text-gray-800 mb-2\">Authenticating...</h2>\n                    <p className=\"text-gray-500 text-sm\">Please wait while we complete your login</p>\n                </>\n            ) : error ? (\n                <>\n                    <div className=\"w-16 h-16 mx-auto mb-6 rounded-full bg-red-100 flex items-center justify-center\">\n                        <svg className=\"w-8 h-8 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                        </svg>\n                    </div>\n                    <h2 className=\"text-xl font-bold text-gray-800 mb-2\">Authentication Failed</h2>\n                    <p className=\"text-gray-500 text-sm mb-6\">{error}</p>\n                    <button\n                        onClick={() => router.push('/login')}\n                        className=\"px-6 py-3 bg-gradient-to-r from-sky-500 to-blue-600 text-white rounded-lg font-semibold hover:from-sky-600 hover:to-blue-700 transition-all\"\n                    >\n                        Back to Login\n                    </button>\n                </>\n            ) : null}\n        </div>\n    );\n}\n\nfunction LoadingFallback() {\n    return (\n        <div className=\"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 text-center\">\n            <div className=\"w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-br from-sky-100 to-blue-100 flex items-center justify-center\">\n                <svg className=\"w-8 h-8 text-sky-500 animate-spin\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n            </div>\n            <h2 className=\"text-xl font-bold text-gray-800 mb-2\">Loading...</h2>\n        </div>\n    );\n}\n\nexport default function AuthenticatePage() {\n    return (\n        <div className=\"min-h-screen w-full flex items-center justify-center bg-gradient-to-r from-[#0062E6] to-[#33AEFF]\">\n            <Suspense fallback={<LoadingFallback />}>\n                <AuthenticateContent />\n            </Suspense>\n        </div>\n    );\n}\n\n"],"names":[],"mappings":"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"}