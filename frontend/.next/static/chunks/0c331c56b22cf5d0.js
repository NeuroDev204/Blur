(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55324,e=>{"use strict";var t=e.i(81949),r=e.i(14),a=e.i(42094);let s=t.default.create({baseURL:r.API_BASE_URL,timeout:3e4,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let t=(0,a.getToken)();return t&&e.headers&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{if(e.response){let{status:t}=e.response;401===t&&((0,a.removeToken)(),window.location.href="/login")}return Promise.reject(e)}),e.s(["default",0,s])},69620,73665,55436,94983,45423,80331,26154,48262,60319,e=>{"use strict";var t=e.i(40141);function r(e){return(0,t.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M96 256h320M96 176h320M96 336h320"},child:[]}]})(e)}function a(e){return(0,t.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"},child:[]}]})(e)}function s(e){return(0,t.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(e)}e.s(["IoReorderThreeOutline",()=>r],69620),e.s(["MdEdit",()=>s,"MdLogout",()=>a],73665);var o=e.i(43476),l=e.i(75254);let i=(0,l.default)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]),n=(0,l.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>n],55436);let c=(0,l.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);e.s(["MessageCircle",()=>c],94983);let d=(0,l.default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);e.s(["Bell",()=>d],45423);let u=(0,l.default)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),g=(0,l.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),h=[{title:"Home",icon:(0,o.jsx)(i,{className:"text-gray-500",strokeWidth:1.5}),activeIcon:(0,o.jsx)(i,{className:"text-blue-500",strokeWidth:2,fill:"rgba(59, 130, 246, 0.1)"}),gradient:"from-blue-400 to-blue-600",bgColor:"bg-blue-50",hoverBg:"hover:bg-blue-50/50"},{title:"Search",icon:(0,o.jsx)(n,{className:"text-gray-500",strokeWidth:1.5}),activeIcon:(0,o.jsx)(n,{className:"text-indigo-500",strokeWidth:2,fill:"rgba(99, 102, 241, 0.1)"}),gradient:"from-indigo-400 to-indigo-600",bgColor:"bg-indigo-50",hoverBg:"hover:bg-indigo-50/50"},{title:"Message",icon:(0,o.jsx)(c,{className:"text-gray-500",strokeWidth:1.5}),activeIcon:(0,o.jsx)(c,{className:"text-emerald-500",strokeWidth:2,fill:"rgba(16, 185, 129, 0.1)"}),gradient:"from-emerald-400 to-emerald-600",bgColor:"bg-emerald-50",hoverBg:"hover:bg-emerald-50/50"},{title:"Notification",icon:(0,o.jsx)(d,{className:"text-gray-500",strokeWidth:1.5}),activeIcon:(0,o.jsx)(d,{className:"text-rose-500",strokeWidth:2,fill:"rgba(244, 63, 94, 0.1)"}),gradient:"from-rose-400 to-rose-600",bgColor:"bg-rose-50",hoverBg:"hover:bg-rose-50/50"},{title:"Create",icon:(0,o.jsx)(u,{className:"text-gray-500",strokeWidth:1.5}),activeIcon:(0,o.jsx)(u,{className:"text-violet-500",strokeWidth:2,fill:"rgba(139, 92, 246, 0.1)"}),gradient:"from-violet-400 to-violet-600",bgColor:"bg-violet-50",hoverBg:"hover:bg-violet-50/50"},{title:"Profile",icon:(0,o.jsx)(g,{className:"text-gray-500",strokeWidth:1.5}),activeIcon:(0,o.jsx)(g,{className:"text-amber-500",strokeWidth:2,fill:"rgba(245, 158, 11, 0.1)"}),gradient:"from-amber-400 to-amber-600",bgColor:"bg-amber-50",hoverBg:"hover:bg-amber-50/50"}];e.s(["menuItems",0,h],80331);var f=e.i(37727);e.s(["default",0,({isOpen:e,onClose:t})=>e?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-50",onClick:t}),(0,o.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:(0,o.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden animate-scaleIn",children:[(0,o.jsxs)("div",{className:"relative pt-8 pb-4 px-6 bg-gradient-to-r from-sky-50 to-blue-50 border-b border-gray-100 text-center",children:[(0,o.jsx)("button",{onClick:t,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 transition-colors",children:(0,o.jsx)(f.X,{size:20,className:"text-gray-500"})}),(0,o.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,o.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-red-100 to-orange-100 rounded-full flex items-center justify-center",children:(0,o.jsx)(a,{size:32,className:"text-red-500"})}),(0,o.jsx)("h2",{className:"text-xl font-bold bg-gradient-to-r from-red-500 to-orange-500 bg-clip-text text-transparent",children:"Logged Out"})]})]}),(0,o.jsxs)("div",{className:"text-center py-8 px-6",children:[(0,o.jsx)("p",{className:"text-gray-600 leading-relaxed",children:"You have been logged out successfully. Please sign in to continue using the app."}),(0,o.jsx)("div",{className:"mt-4 p-3 bg-sky-50 rounded-lg border border-sky-100",children:(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["ðŸ’¡ ",(0,o.jsx)("strong",{children:"Tip:"})," Remember to log out from shared devices for security."]})})]}),(0,o.jsx)("div",{className:"flex justify-center gap-3 pb-6 px-6 bg-gray-50 border-t border-gray-100 pt-4",children:(0,o.jsx)("button",{onClick:t,className:"px-8 py-2.5 bg-gradient-to-r from-sky-400 to-blue-500 text-white rounded-xl font-semibold hover:from-sky-500 hover:to-blue-600 hover:-translate-y-0.5 hover:shadow-lg active:scale-[0.98] transition-all duration-200",children:"Got it"})})]})})]}):null],26154);class m extends Error{}m.prototype.name="InvalidTokenError";var p=e.i(42094);e.s(["getUserDetails",0,()=>{let e=(0,p.getToken)();if(null!==e)try{return function(e,t){let r;if("string"!=typeof e)throw new m("Invalid token specified: must be a string");t||(t={});let a=+(!0!==t.header),s=e.split(".")[a];if("string"!=typeof s)throw new m(`Invalid token specified: missing part #${a+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(s)}catch(e){throw new m(`Invalid token specified: invalid base64 for part #${a+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new m(`Invalid token specified: invalid json for part #${a+1} (${e.message})`)}}(e)}catch(e){console.log("Invalid token",e)}return null}],48262);var x=e.i(71645),v=e.i(81949),b=e.i(21151),y=e.i(14);e.s(["useUnreadMessages",0,(e={})=>{let{autoRefresh:t=!0,refreshInterval:r=3e4}=e,[a,s]=(0,x.useState)(0),[o,l]=(0,x.useState)({}),[i,n]=(0,x.useState)(!1),{registerMessageCallbacks:c}=(0,b.useSocket)(),d=(0,x.useCallback)(async()=>{let e=(0,p.getToken)();if(!e)return void console.warn("âš ï¸ No token found, cannot fetch unread counts");n(!0);try{let t=await v.default.get(`${y.API_BASE_URL}/chat/conversations/my-conversations`,{headers:{Accept:"application/json",Authorization:`Bearer ${e}`}}),r=t.data?.result||[];if(0===r.length){s(0),l({}),n(!1);return}let a=r.map(async t=>{try{let r=await v.default.get(`${y.API_BASE_URL}/chat/conversations/${t.id}/unread-count`,{headers:{Accept:"application/json",Authorization:`Bearer ${e}`}});return{conversationId:t.id,count:r.data?.result||0}}catch(e){return console.error(`âŒ Error fetching unread for ${t.id}:`,e),{conversationId:t.id,count:0}}}),o=await Promise.all(a),i=0,c={};o.forEach(({conversationId:e,count:t})=>{i+=t,c[e]=t}),s(i),l(c),console.log("ðŸ“Š Unread counts updated:",{total:i,byConversation:c})}catch(e){console.error("âŒ Error fetching unread counts:",e)}finally{n(!1)}},[]),u=(0,x.useCallback)(async e=>{let t=(0,p.getToken)();if(t&&e)try{await v.default.put(`${y.API_BASE_URL}/chat/conversations/mark-as-read`,null,{params:{conversationId:e},headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`}}),console.log(`âœ… Marked conversation ${e} as read`),l(t=>({...t,[e]:0})),s(t=>Math.max(0,t-(o[e]||0))),setTimeout(()=>{d()},500)}catch(e){console.error("âŒ Error marking as read:",e)}},[o,d]),g=(0,x.useCallback)(()=>{d()},[d]);return(0,x.useEffect)(()=>{d()},[d]),(0,x.useEffect)(()=>{if(!t)return;let e=setInterval(()=>{d()},r);return()=>clearInterval(e)},[t,r,d]),(0,x.useEffect)(()=>{c&&c({onMessageReceived:e=>{console.log("ðŸ“¨ New message received, updating unread count"),l(t=>({...t,[e.conversationId]:(t[e.conversationId]||0)+1})),s(e=>e+1),setTimeout(()=>{d()},500)},onMessageSent:()=>{console.log("âœ… Message sent, may need to refresh unread count"),setTimeout(()=>{d()},500)}})},[c,d]),{totalUnread:a,unreadByConversation:o,isLoading:i,refreshUnreadCount:g,markAsRead:u}}],60319)},57339,9505,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(69620),s=e.i(73665),o=e.i(80331),l=e.i(18566),i=e.i(26154),n=e.i(42094),c=e.i(48262),d=e.i(60319),u=e.i(55324);let g=async()=>{let e=await u.default.get("/profile/users/myInfo");if(e.data?.code!==1e3)throw Error(e.data?.message||"Failed to fetch user info");return e.data?.result},h=async(e,t)=>{let r=await u.default.put(`/profile/users/${e}`,t);if(r.data?.code!==1e3)throw Error(r.data?.message||"Failed to update profile");return r.data?.result},f=async e=>{let t=await u.default.put(`/profile/users/follow/${e}`,{});return t.data?.result},m=async e=>{let t=await u.default.put(`/profile/users/unfollow/${e}`,{});return t.data?.result},p=async e=>{let t=await u.default.post("/profile/users/search",{keyword:e});return t.data?.result||[]},x=async e=>{let t=await u.default.get(`/profile/users/${e}`);if(t.data?.code!==1e3)throw Error(t.data?.message||"Failed to fetch profile");return t.data?.result},v=async e=>{let t=await u.default.get(`/profile/users/follower/${e}`);return t.data?.result||[]},b=async e=>{let t=await u.default.get(`/profile/users/following/${e}`);return t.data?.result||[]};e.s(["fetchUserInfo",0,g,"fetchUserProfileById",0,x,"followUser",0,f,"getFollowers",0,v,"getFollowings",0,b,"searchUsersByUserName",0,p,"unfollowUser",0,m,"updateUserProfile",0,h],9505);let y=async()=>{let e=localStorage.getItem("token");if(e)try{await u.default.post("/identity/auth/logout",{token:e})}catch(e){console.error("Logout API error:",e)}(0,n.removeToken)()};var k=e.i(5766);e.s(["SidebarComponent",0,({onPostCreate:e=()=>{}})=>{let[u,h]=(0,r.useState)(),[f,m]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[w,j]=(0,r.useState)(null),N=(0,l.useRouter)(),I=(0,l.usePathname)(),{totalUnread:M}=(0,d.useUnreadMessages)({autoRefresh:!0,refreshInterval:3e4});(0,r.useEffect)(()=>{(async()=>{if((0,n.getToken)()&&(0,c.getUserDetails)())try{let e=await g();j(e)}catch(e){console.error("Error:",e)}})()},[]),(0,r.useEffect)(()=>{"/"===I?h("Home"):"/profile"===I?h("Profile"):"/message"===I?h("Message"):"/notification"===I?h("Notification"):"/search"===I&&h("Search")},[I]);let C=async e=>{try{e.preventDefault(),await y(),(0,n.removeToken)(),k.default.success("Logout successful!"),N.push("/login")}catch(e){k.default.error(e.message)}};return(0,t.jsxs)("div",{className:"flex h-screen w-full overflow-hidden",children:[(0,t.jsxs)("div",{className:"w-64 fixed top-0 left-0 h-screen transition-all duration-300 flex flex-col justify-between px-4 py-6 bg-white border-r border-gray-200 shadow-sm z-50",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-8",children:(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-sky-400 to-blue-500 rounded-full blur-md opacity-20 group-hover:opacity-30 transition-opacity"}),(0,t.jsx)("img",{className:"relative w-16 h-16 rounded-full cursor-pointer hover:scale-105 transition-transform duration-200 shadow-lg",src:"/logo.webp",alt:"Logo",onClick:()=>N.push("/")})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto space-y-1",children:o.menuItems.map(e=>(0,t.jsxs)("div",{onClick:()=>(e=>{switch(h(e),e){case"Profile":N.push("/profile");break;case"Home":N.push("/");break;case"Create":b(!0);break;case"Message":N.push("/message");break;case"Notification":N.push("/notification");break;case"Search":N.push("/search")}})(e.title),className:`group relative flex items-center gap-4 py-3 px-4 rounded-xl cursor-pointer transition-all duration-200 ${u===e.title?"bg-gradient-to-r from-sky-50 to-blue-50 text-sky-600":"hover:bg-gray-50 text-gray-700"}`,children:["Profile"===e.title&&w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:`absolute inset-0 rounded-full blur-sm transition-opacity ${u===e.title?"bg-gradient-to-br from-sky-400 to-blue-500 opacity-20":"bg-gray-400 opacity-0 group-hover:opacity-10"}`}),(0,t.jsx)("img",{src:w.imageUrl||"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_640.png",alt:"avatar",className:"relative w-7 h-7 rounded-full object-cover border-2 border-white shadow-sm"})]}),(0,t.jsxs)("span",{className:`font-medium text-sm ${u===e.title?"font-semibold":""}`,children:[w.firstName," ",w.lastName]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:`relative text-xl transition-transform duration-200 ${u===e.title?"scale-110":"group-hover:scale-105"}`,children:[u===e.title?e.activeIcon:e.icon,"Message"===e.title&&M>0&&(0,t.jsx)("div",{className:"absolute -top-2 -right-2 min-w-[18px] h-[18px] flex items-center justify-center bg-gradient-to-r from-red-500 to-pink-500 text-white text-[10px] font-bold rounded-full border-2 border-white shadow-lg animate-pulse",children:M>99?"99+":M})]}),(0,t.jsx)("span",{className:`font-medium text-sm flex items-center gap-2 ${u===e.title?"font-semibold":""}`,children:e.title})]}),u===e.title&&(0,t.jsx)("div",{className:"absolute left-0 w-1 h-8 bg-gradient-to-b from-sky-400 to-blue-500 rounded-r-full"})]},e.title))}),(0,t.jsxs)("div",{className:"relative mt-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 py-3 px-4 rounded-xl hover:bg-gray-50 cursor-pointer transition-all duration-200 text-gray-700 group",onClick:()=>m(!f),children:[(0,t.jsx)(a.IoReorderThreeOutline,{className:"text-2xl group-hover:scale-105 transition-transform"}),(0,t.jsx)("span",{className:"font-medium text-sm",children:"More"})]}),f&&(0,t.jsx)("div",{className:"absolute bottom-16 left-0 right-0 mx-2 bg-white shadow-xl border border-gray-100 rounded-xl overflow-hidden animate-scaleIn",children:(0,t.jsxs)("button",{onClick:C,className:"w-full flex items-center gap-3 px-4 py-3 text-sm text-left hover:bg-red-50 transition-colors group",children:[(0,t.jsx)(s.MdLogout,{className:"text-lg text-gray-600 group-hover:text-red-500 transition-colors"}),(0,t.jsx)("span",{className:"font-medium text-gray-700 group-hover:text-red-600",children:"Log Out"})]})})]})]}),(0,t.jsx)(i.default,{isOpen:p,onClose:()=>x(!1)})]})}],57339)}]);